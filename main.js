(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,n(a.key),a)}}function n(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}const r=function(){return t=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.text=e,this.columnId=n,this.cardIndex=r,this.element=this.render()},(n=[{key:"render",value:function(){var t=document.createElement("div");return t.classList.add("card"),t.draggable=!0,t.dataset.columnId=this.columnId,t.dataset.cardIndex=this.cardIndex,t.innerHTML="".concat(this.text,' <span class="delete-card" data-column-id="').concat(this.columnId,'" data-card-index="').concat(this.cardIndex,'">&times;</span>'),t}},{key:"updateIndex",value:function(t){this.cardIndex=t,this.element.dataset.cardIndex=t,this.element.querySelector(".delete-card").dataset.cardIndex=t}}])&&e(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n}();function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,o(r.key),r)}}function o(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}const d=function(){return t=function t(e,n){var a=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.title=n,this.cards=i.map((function(t,e){return new r(t,a.id,e)})),this.element=this.render(),this.cardsContainer=this.element.querySelector(".cards"),this.addCardButton=this.element.querySelector(".add-card"),this.form=this.createForm(),this.element.appendChild(this.form),this.addFormListeners()},(e=[{key:"render",value:function(){var t=document.createElement("div");return t.classList.add("column"),t.innerHTML="\n            <h2>".concat(this.title,'</h2>\n            <div class="cards" data-column-id="').concat(this.id,'"></div>\n            <button class="add-card" data-column-id="').concat(this.id,'">+ Add another card</button>\n        '),this.cards.forEach((function(e){t.querySelector(".cards").appendChild(e.element)})),t}},{key:"createForm",value:function(){var t=document.createElement("form");return t.className="form-field",t.innerHTML='\n            <textarea placeholder="Enter card text..." rows="3"></textarea>\n            <div class="form-btn-box">\n                <button type="submit">Add</button>\n                <button type="button" class="cancel-btn">Ã—</button>\n            </div>\n        ',t.style.display="none",t}},{key:"addFormListeners",value:function(){var t=this,e=this.form.querySelector("textarea"),n=this.form.querySelector(".cancel-btn");this.form.addEventListener("submit",(function(n){n.preventDefault();var r=e.value.trim();r&&(t.addCard(r),t.hideForm(),e.value="")})),n.addEventListener("click",(function(){t.hideForm(),e.value=""}))}},{key:"showForm",value:function(){this.addCardButton.style.display="none",this.form.style.display="block"}},{key:"hideForm",value:function(){this.addCardButton.style.display="block",this.form.style.display="none"}},{key:"addCard",value:function(t){var e=new r(t,this.id,this.cards.length);this.cards.push(e),this.cardsContainer.appendChild(e.element),this.updateCardIndexes()}},{key:"removeCard",value:function(t){this.cards=this.cards.filter((function(e){return e.element!==t})),t.remove()}},{key:"renderCards",value:function(){var t=this;this.cardsContainer.innerHTML="",this.cards.forEach((function(e){t.cardsContainer.appendChild(e.element)}))}},{key:"updateCardIndexes",value:function(){this.cards.forEach((function(t,e){t.updateIndex(e)}))}}])&&i(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,u(r.key),r)}}function u(t){var e=function(t){if("object"!=c(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==c(e)?e:e+""}new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.loadState(),this.draggedCard=null,this.appElement=document.getElementById("app"),this.renderColumns(),this.addEventListeners()},(e=[{key:"renderColumns",value:function(){var t=this;this.appElement.innerHTML="",this.columns.forEach((function(e){return t.appElement.appendChild(e.element)}))}},{key:"addEventListeners",value:function(){var t=this;this.appElement.addEventListener("click",(function(e){if(e.target.classList.contains("add-card")){var n=t.findColumnById(e.target.dataset.columnId);n&&n.showForm()}})),this.appElement.addEventListener("click",(function(e){if(e.target.classList.contains("delete-card")){e.stopPropagation();var n=t.findColumnById(e.target.dataset.columnId);if(!n)return;var r=e.target.closest(".card");n.removeCard(r),t.saveState()}})),this.appElement.addEventListener("dragstart",(function(e){e.target.classList.contains("card")&&(t.draggedCard=e.target,e.target.classList.add("dragging"))})),this.appElement.addEventListener("dragend",(function(){t.draggedCard&&(t.draggedCard.classList.remove("dragging"),t.draggedCard=null)})),this.appElement.addEventListener("dragover",(function(e){e.preventDefault();var n=e.target.closest(".column");if(n){var r=n.querySelector(".cards"),a=t.getDragAfterElement(r,e.clientY);t.draggedCard&&(a?r.insertBefore(t.draggedCard,a):r.appendChild(t.draggedCard))}})),this.appElement.addEventListener("drop",(function(e){var n=e.target.closest(".column");if(n&&t.draggedCard){var r=t.findColumnById(t.draggedCard.dataset.columnId),a=t.findColumnById(n.dataset.columnId);r&&a&&(r.removeCard(t.draggedCard),a.addCard(t.draggedCard.textContent.trim()),t.saveState())}}))}},{key:"getDragAfterElement",value:function(t,e){return function(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t.querySelectorAll(".card:not(.dragging)")).find((function(t){return e<=t.getBoundingClientRect().top+t.offsetHeight/2}))}},{key:"findColumnById",value:function(t){return this.columns.find((function(e){return e.id==t}))}},{key:"saveState",value:function(){localStorage.setItem("trelloState",JSON.stringify(this.columns.map((function(t){return{id:t.id,title:t.title,cards:t.cards.map((function(t){return t.text}))}}))))}},{key:"loadState",value:function(){var t=JSON.parse(localStorage.getItem("trelloState"))||[{id:1,title:"TODO",cards:[]},{id:2,title:"IN PROGRESS",cards:[]},{id:3,title:"DONE",cards:[]}];this.columns=t.map((function(t){return new d(t.id,t.title,t.cards)}))}}])&&l(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}())})();